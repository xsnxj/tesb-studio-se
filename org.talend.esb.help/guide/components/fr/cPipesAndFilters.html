<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>cPipesAndFilters</title><meta name="generator" content="DocBook XSL-NS Stylesheets V1.76.1"><link rel="home" href="index.html" title="Talend Open Studio"><link rel="up" href="ch03.html" title="Chapitre&nbsp;3.&nbsp;Composants Messaging"><link rel="prev" href="cMessagingEndpoint.html" title="cMessagingEndpoint"><link rel="next" href="cTalendJob.html" title="cTalendJob"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div lang="fr" class="section" title="cPipesAndFilters"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="cPipesAndFilters"></a>cPipesAndFilters</h2></div></div></div><div class="mediaobject"><img src="../images/cPipesAndFilters_icon32.png"></div><div class="section" title="Propri&eacute;t&eacute;s du cPipesAndFilters"><div class="titlepage"><div><div><h3 class="title"><a name="d0e7132"></a>Propri&eacute;t&eacute;s du cPipesAndFilters</h3></div></div></div><div class="informaltable"><table border="1"><colgroup><col class="c1"><col class="c2"><col class="c3"></colgroup><tbody><tr><td valign="top">
							<p>
								<span class="bold"><strong>Famille de composant</strong></span>
							</p>
						</td><td colspan="2" valign="top">
							<p>Messaging</p>
						</td></tr><tr><td valign="top">
							<p>
								<span class="bold"><strong>Fonction</strong></span>
							</p>
						</td><td colspan="2" valign="top">
							<p>Le composant <span class="bold"><strong>cPipesAndFilters</strong></span> divise le traitement
								d'un message en une s&eacute;quence d'instances d'endpoints ind&eacute;pendants,
								pouvant &ecirc;tre reli&eacute;s entre eux. </p>
						</td></tr><tr><td valign="top">
							<p>
								<span class="bold"><strong>Objectif</strong></span>
							</p>
						</td><td colspan="2" valign="top">
							<p>Ce composant vous permet de diviser le routage d'un message en une s&eacute;rie d'&eacute;tapes de
								traitement ind&eacute;pendantes.</p>
						</td></tr><tr><td valign="top">
							<p>
								<span class="bold"><strong>Basic settings</strong></span>
							</p>
						</td><td valign="top">
							<p>
								<span class="emphasis"><em>URI list</em></span>
							</p>
						</td><td valign="top">
							<p>Cliquez sur le bouton <span class="bold"><strong>[+]</strong></span> pour ajouter de nouvelles
								lignes pour les URIs identifiant les endpoints.</p>
						</td></tr><tr><td valign="top">
							<p>
								<span class="bold"><strong>Utilisation</strong></span>
							</p>
						</td><td colspan="2" valign="top">
							<p>Le <span class="bold"><strong>cPipesAndFilters</strong></span> est g&eacute;n&eacute;ralement utilis&eacute; au milieu
								d'une Route.</p>
						</td></tr><tr><td valign="top">
							<p>
								<span class="bold"><strong>Limitation</strong></span>
							</p>
						</td><td colspan="2">
							<p>&nbsp;n/a</p>
						</td></tr></tbody></table></div></div><div class="section" title="Sc&eacute;nario : Utiliser un cPipesAndFilters pour traiter une t&acirc;che en s&eacute;quence"><div class="titlepage"><div><div><h3 class="title"><a name="d0e7242"></a>Sc&eacute;nario : Utiliser un cPipesAndFilters pour traiter une t&acirc;che en s&eacute;quence</h3></div></div></div><p>Dans ce sc&eacute;nario, un composant <span class="bold"><strong>cPipesAndFilters</strong></span> est
			utilis&eacute; pour qu'un message envoy&eacute; d'un endpoint &eacute;metteur passe par une phase A et une
			phase B.  Lorsque ces deux phases sont termin&eacute;es, le message est rout&eacute; vers un syst&egrave;me
			de fichier, l'endpoint r&eacute;cepteur des messages.</p><div class="mediaobject"><img src="../images/use_case_cpipesandfilters1.png"></div><div class="section" title="D&eacute;poser et relier les composants"><div class="titlepage"><div><div><h4 class="title"><a name="d0e7253"></a>D&eacute;poser et relier les composants</h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="&Eacute;tape 1"><p>Dans le dossier <span class="bold"><strong>Messaging</strong></span> de la <span class="bold"><strong>Palette</strong></span>, d&eacute;posez deux composants <span class="bold"><strong>cFile</strong></span> dans l'espace de mod&eacute;lisation graphique, un
						comme &eacute;metteur de message et l'autre comme r&eacute;cepteur de message et
						nommez-les respectivement <span class="italic">Sender</span> et
							<span class="italic">Receiver</span> afin de mieux identifier
						leur r&ocirc;le dans la Route.</p></li><li class="step" title="&Eacute;tape 2"><p>Du dossier <span class="bold"><strong>Messaging</strong></span>, d&eacute;posez un
						composant <span class="bold"><strong>cPipesAndFilters</strong></span> dans l'espace de
						mod&eacute;lisation graphique, entre les deux fichiers <span class="bold"><strong>cFile</strong></span>.</p></li><li class="step" title="&Eacute;tape 3"><p>Du dossier <span class="bold"><strong>Messaging</strong></span>, d&eacute;posez deux
							<span class="bold"><strong>cMessagingEndpoint</strong></span> dans l'espace de
						mod&eacute;lisation graphique, un comme endpoint de l'&eacute;tape A et l'autre comme
						endpoint de l'&eacute;tape B. Nommez-les <span class="italic">Stage_A</span>
						et <span class="italic">Stage_B</span> respectivement, afin de mieux
						identifier leur r&ocirc;le dans la Route.</p></li><li class="step" title="&Eacute;tape 4"><p>Du dossier <span class="bold"><strong>Processor</strong></span>, d&eacute;posez trois
							<span class="bold"><strong>cProcessor</strong></span> dans l'espace de
						mod&eacute;lisation graphique pour monitorer les messages re&ccedil;us par les endpoints
						r&eacute;cepteur, de l'&eacute;tape A et de l'&eacute;tape B et nommez-les respectivement
							<span class="italic">Monitor_Receiver</span>, <span class="italic">Monitor_stage_A</span>, et <span class="italic">Monitor_stage_B</span> afin de mieux identifier leur r&ocirc;le dans la
						Route.</p></li><li class="step" title="&Eacute;tape 5"><p>Cliquez-droit sur le composant <span class="bold"><strong>cFile</strong></span>
						nomm&eacute; <span class="italic">Sender</span>, s&eacute;lectionnez <span class="bold"><strong>Row</strong></span> &gt; <span class="bold"><strong>Route</strong></span> dans
						le menu contextuel et cliquez sur le <span class="bold"><strong>cPipesAndFilters</strong></span>.</p><p>R&eacute;p&eacute;tez cette &eacute;tape pour configurer les autres liens <span class="bold"><strong>Row</strong></span> &gt; <span class="bold"><strong>Route</strong></span>.</p></li></ol></div></div><div class="section" title="Configurer les composants"><div class="titlepage"><div><div><h4 class="title"><a name="d0e7346"></a>Configurer les composants</h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="&Eacute;tape 1"><p>Double-cliquez sur le composant <span class="bold"><strong>cFile</strong></span>
						nomm&eacute; <span class="italic">Sender</span> pour ouvrir sa vue <span class="bold"><strong>Basic settings</strong></span>.</p><div class="mediaobject"><img src="../images/use_case_cpipesandfilters2.png"></div></li><li class="step" title="&Eacute;tape 2"><p>Dans le champ <span class="bold"><strong>Path</strong></span>, saisissez le chemin
						d'acc&egrave;s au dossier contenant les fichiers source ou parcourez votre syst&egrave;me
						jusqu'&agrave; celui-ci.</p></li><li class="step" title="&Eacute;tape 3"><p>Dans la liste <span class="bold"><strong>Encoding</strong></span>, s&eacute;lectionnez le
						type d'encodage de vos fichiers source. Laissez les autres param&egrave;tres tels
						qu'ils sont.</p></li><li class="step" title="&Eacute;tape 4"><p>R&eacute;p&eacute;tez ces &eacute;tapes pour configurer les chemins d'acc&egrave;s aux fichiers de
						sortie ainsi que le type d'encodage, dans la vue <span class="bold"><strong>Basic
							settings</strong></span> du composant <span class="bold"><strong>cFile</strong></span>
						nomm&eacute; <span class="italic">Receiver</span>. </p></li><li class="step" title="&Eacute;tape 5"><p>Double-cliquez sur le <span class="bold"><strong>cPipesAndFilters</strong></span>
						pour ouvrir sa vue <span class="bold"><strong>Basic settings</strong></span>.</p><div class="mediaobject"><img src="../images/use_case_cpipesandfilters4.png"></div></li><li class="step" title="&Eacute;tape 6"><p>Cliquez sur le bouton <span class="bold"><strong>[+]</strong></span> afin d'ajouter
						deux lignes &agrave; la table <span class="bold"><strong>URI list</strong></span> et
						saisissez <code class="code">"direct:a"</code> dans la premi&egrave;re ligne, puis
							<code class="code">"direct:b"</code> dans la seconde ligne pour d&eacute;finir les URIs de
						l'&eacute;tape A et de l'&eacute;tape B &agrave; travers lesquelles les messages vont
						passer.</p></li><li class="step" title="&Eacute;tape 7"><p>Double-cliquez sur le <span class="bold"><strong>cMessagingEndpoint</strong></span>
						nomm&eacute; <span class="italic">Stage_A</span> pour configurer les
						propri&eacute;t&eacute;s simples du composant, dans sa vue <span class="bold"><strong>Basic
							settings</strong></span> et d&eacute;finir l'URI de l'&eacute;tape A.</p><div class="mediaobject"><img src="../images/use_case_cpipesandfilters6.png"></div><p>R&eacute;p&eacute;tez cette &eacute;tape pour d&eacute;finir l'URI de l'&eacute;tape B dans la vue <span class="bold"><strong>Basic settings</strong></span> du <span class="bold"><strong>cMessagingEndpoint</strong></span> nomm&eacute; <span class="italic">Stage_B</span>.</p></li><li class="step" title="&Eacute;tape 8"><p>Double-cliquez sur le composant <span class="bold"><strong>cProcessor</strong></span> nomm&eacute; <span class="italic">Monitor_Receiver</span> pour ouvrir sa vue <span class="bold"><strong>Basic settings</strong></span> et personnaliser le code dans la zone
							<span class="bold"><strong>Code</strong></span> pour afficher le nom des fichiers
						re&ccedil;us par le r&eacute;cepteur, comme suit :</p><pre class="programlisting">System.out.println("Message sent to Receiver: "+
exchange.getIn().getHeader("CamelFileName"));</pre><p>R&eacute;p&eacute;tez cette &eacute;tape pour personnaliser le code dans les deux autres
						composants <span class="bold"><strong>cProcessor</strong></span> afin d'afficher le
						nom des fichiers des messages re&ccedil;us dans les &eacute;tapes A et B, respectivement
						:</p><pre class="programlisting">System.out.println("Message sent to stage A: "+
exchange.getIn().getHeader("CamelFileName"));</pre><pre class="programlisting">System.out.println("Message sent to stage B: "+
exchange.getIn().getHeader("CamelFileName"));</pre></li><li class="step" title="&Eacute;tape 9"><p>Appuyez sur <span class="bold"><strong>Ctrl+S</strong></span> pour sauvegarder votre
						Route.</p></li></ol></div></div><div class="section" title="Visualiser le code et ex&eacute;cuter la Route"><div class="titlepage"><div><div><h4 class="title"><a name="d0e7474"></a>Visualiser le code et ex&eacute;cuter la Route</h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="&Eacute;tape 1"><p> Cliquez sur l'onglet <span class="bold"><strong>Code</strong></span> au bas de
						l'espace de mod&eacute;lisation graphique pour visualiser le code g&eacute;n&eacute;r&eacute;.</p><div class="mediaobject"><img src="../images/use_case_cpipesandfilters10.png"></div><p>Comme affich&eacute; dans le code, les messages envoy&eacute;s depuis (<code class="code">from</code>) l'&eacute;metteur
							(<code class="code">Sender</code>) sont redirig&eacute;s vers des endpoints identifi&eacute;s par
							<code class="code">direct:a</code> et <code class="code">direct:b</code> par le
							<code class="code">cPipesAndFilters_1</code> avant d'&ecirc;tre rout&eacute;s par le r&eacute;cepteur
							(<code class="code">Receiver</code>).</p></li><li class="step" title="&Eacute;tape 2"><p>Appuyez sur <span class="bold"><strong>F6</strong></span> pour ex&eacute;cuter votre Route.</p><p>R&eacute;sultat : La livraison du message passe par l'&eacute;tape A (<span class="italic">stage
							A</span>) puis par l'&eacute;tape B (<span class="italic">stage
							B</span>) avant d'atteindre le r&eacute;cepteur (<span class="italic">Receiver</span>).</p><div class="mediaobject"><img src="../images/use_case_cpipesandfilters11.png"></div></li></ol></div></div></div></div></body></html>