<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>cMulticast</title><meta name="generator" content="DocBook XSL-NS Stylesheets V1.76.1"><link rel="home" href="index.html" title="Talend Open Studio"><link rel="up" href="ch06.html" title="Chapter&nbsp;6.&nbsp;Routing components"><link rel="prev" href="cMessageRouter.html" title="cMessageRouter"><link rel="next" href="cRecipientList.html" title="cRecipientList"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div lang="EN" class="section" title="cMulticast"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="cMulticast"></a>cMulticast</h2></div></div></div><p>
		<span class="inlinemediaobject"><img src="../images/cMulticast_icon32.png"></span>
	</p><div class="section" title="cMulticast properties"><div class="titlepage"><div><div><h3 class="title"><a name="d0e10440"></a>cMulticast properties</h3></div></div></div><div class="informaltable"><table border="1"><colgroup><col class="c1"><col class="c2"><col class="c3"></colgroup><tbody><tr><td valign="top">
							<p>
								<span class="bold"><strong>Component Family</strong></span>
							</p>
						</td><td colspan="2" valign="top">
							<p>Routing</p>
						</td></tr><tr><td valign="top">
							<p>
								<span class="bold"><strong>Function</strong></span>
							</p>
						</td><td colspan="2" valign="top">
							<p>
								<span class="bold"><strong>cMulticast</strong></span> routes one or more
								messages to a number of endpoints at one go.</p>
						</td></tr><tr><td valign="top">
							<p>
								<span class="bold"><strong>Purpose</strong></span>
							</p>
						</td><td colspan="2" valign="top">
							<p>
								<span class="bold"><strong>cMulticast</strong></span> is used to route one or
								more messages to a number of endpoints at one go and process them in
								different ways.</p>
						</td></tr><tr><td valign="top">
							<p>
								<span class="bold"><strong>Basic settings</strong></span>
							</p>
						</td><td valign="top">
							<p>
								<span class="emphasis"><em>URIS</em></span>
							</p>
						</td><td valign="top">
							<p>Add as many lines as needed in the URIs table to define the
								endpoints to route the message(s) to.</p>
						</td></tr><tr><td valign="top">
							<p> </p>
						</td><td valign="top">
							<p>
								<span class="emphasis"><em>Send in parallel</em></span>
							</p>
						</td><td valign="top">
							<p>Select this check box to multicast the message(s) to the specified
								endpoints simultaneously.</p>
						</td></tr><tr><td valign="top">
							<p> </p>
						</td><td valign="top">
							<p>
								<span class="emphasis"><em>Set timeout</em></span>
							</p>
						</td><td valign="top">
							<p>Select this check box and set a timeout in the <span class="bold"><strong>Timeout</strong></span> field, in milliseconds. If
									<span class="bold"><strong>cMulticast</strong></span> fails to send and
								process all the messages within the set timeframe, it breaks out and
								continues. </p>
							<p>Note that this check box appears only when the <span class="bold"><strong>Send in
									parallel</strong></span> check box is selected.</p>
						</td></tr><tr><td valign="top">
							<p> </p>
						</td><td valign="top">
							<p>
								<span class="emphasis"><em>Use Aggregation Strategy</em></span>
							</p>
						</td><td valign="top">
							<p>Select this check box to refer to a predefined Java bean as an aggregation strategy for
								assembling the messages from the message source into a single
								outgoing message. </p>
							<p>By default, the last message acts as the outgoing message.</p>
						</td></tr><tr><td valign="top">
							<p>
								<span class="bold"><strong>Usage</strong></span>
							</p>
						</td><td colspan="2" valign="top">
							<p>
								<span class="bold"><strong>cMulticast</strong></span> can be used as a middle
								or end component in a Route.</p>
						</td></tr><tr><td valign="top">
							<p>
								<span class="bold"><strong>Limitation</strong></span>
							</p>
						</td><td colspan="2">
							<p>&nbsp;n/a</p>
						</td></tr></tbody></table></div></div><div class="section" title="Scenario: Multicasting a message to two endpoints and using it to enrich the contents received by the third endpoint"><div class="titlepage"><div><div><h3 class="title"><a name="cmulticast-scenario-multicasting_message_to_endpoints"></a>Scenario: Multicasting a message to two endpoints and using it to enrich the contents
			received by the third endpoint</h3></div></div></div><p>In this scenario, a <span class="bold"><strong>cMulticast</strong></span> component is used to
			route a message to two endpoints. Afterwards, that message is added to the contents
			received by the third endpoint by using a <span class="bold"><strong>cContentEnricher</strong></span> component. </p><div class="mediaobject" align="center"><img src="../images/use_case_cmulticast_1.png" align="middle"></div><p>To build the Route, do the following. </p><div class="section" title="Dropping and linking the components"><div class="titlepage"><div><div><h4 class="title"><a name="d0e10638"></a>Dropping and linking the components </h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Drag and drop the following components from the <span class="bold"><strong>Palette</strong></span> onto the workspace: one <span class="bold"><strong>cFile</strong></span>, three <span class="bold"><strong>cMessagingEndpoint</strong></span>, four <span class="bold"><strong>cProcessor</strong></span>, one <span class="bold"><strong>cMulticast</strong></span> and one <span class="bold"><strong>cContentEnricher</strong></span>. For better identification of the components' functionalities, change the labels of the three <span class="bold"><strong>cMessagingEndpoint</strong></span> components to <span class="bold"><strong>direct_a</strong></span>, <span class="bold"><strong>direct_b</strong></span> and <span class="bold"><strong>direct_c</strong></span>, and change the labels of the four <span class="bold"><strong>cProcessor</strong></span> components to <span class="bold"><strong>source_print</strong></span>, <span class="bold"><strong>direct_a_print</strong></span>, <span class="bold"><strong>direct_b_print</strong></span> and <span class="bold"><strong>direct_c_print</strong></span>. </p></li><li class="step" title="Step 2"><p>Link <span class="bold"><strong>cFile</strong></span> to <span class="bold"><strong>source_print</strong></span> using a <span class="bold"><strong>Row</strong></span> &gt; <span class="bold"><strong>Route</strong></span> connection.</p></li><li class="step" title="Step 3"><p>Link <span class="bold"><strong>source_print</strong></span> to <span class="bold"><strong>cMulticast</strong></span> using a <span class="bold"><strong>Row</strong></span> &gt; <span class="bold"><strong>Route</strong></span> connection.</p></li><li class="step" title="Step 4"><p>Link <span class="bold"><strong>direct_a</strong></span> to <span class="bold"><strong>cContentEnricher</strong></span> using a <span class="bold"><strong>Row</strong></span> &gt; <span class="bold"><strong>Route</strong></span> connection.</p></li><li class="step" title="Step 5"><p>Link <span class="bold"><strong>cContentEnricher</strong></span> to <span class="bold"><strong>direct_a_print</strong></span> using a <span class="bold"><strong>Row</strong></span> &gt; <span class="bold"><strong>Route</strong></span> connection.</p></li><li class="step" title="Step 6"><p>Link <span class="bold"><strong>direct_b</strong></span> to <span class="bold"><strong>direct_b_print</strong></span> using a <span class="bold"><strong>Row</strong></span> &gt; <span class="bold"><strong>Route</strong></span> connection.</p></li><li class="step" title="Step 7"><p>Link <span class="bold"><strong>direct_c</strong></span> to <span class="bold"><strong>direct_c_print</strong></span> using a <span class="bold"><strong>Row</strong></span> &gt; <span class="bold"><strong>Route</strong></span> connection.</p></li></ol></div></div><div class="section" title="Configuring the components"><div class="titlepage"><div><div><h4 class="title"><a name="d0e10780"></a>Configuring the components</h4></div></div></div><div class="procedure" title="Procedure&nbsp;6.1.&nbsp;Configuring the data source and the multicast recipients"><a name="d0e10783"></a><p class="title"><b>Procedure&nbsp;6.1.&nbsp;Configuring the data source and the multicast recipients</b></p><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Double-click <span class="bold"><strong>cFile</strong></span> to open its <span class="bold"><strong>Basic settings</strong></span> view in the <span class="bold"><strong>Component</strong></span> tab. </p><div class="mediaobject" align="center"><img src="../images/use_case_cmulticast_2.png" align="middle"></div></li><li class="step" title="Step 2"><p>In the <span class="bold"><strong>Path</strong></span> field, type in the path to the source message, for example, <span class="italic">"E:/data/input/multicast"</span>. Keep the default settings for other fields. </p></li><li class="step" title="Step 3"><p>Double-click <span class="bold"><strong>source_print</strong></span> to open its <span class="bold"><strong>Basic settings</strong></span> view in the <span class="bold"><strong>Component</strong></span> tab. </p><div class="mediaobject" align="center"><img src="../images/use_case_cmulticast_3.png" align="middle"></div></li><li class="step" title="Step 4"><p>In the <span class="bold"><strong>Code</strong></span> box, enter the code below to get the source message body and print it out.</p><p>
						</p><pre class="programlisting">String body = exchange.getIn().getBody(String.class);
System.out.println("Here is the original body:" 
+ exchange.getIn().getBody(String.class));</pre><p>
					</p></li><li class="step" title="Step 5"><p>Double-click <span class="bold"><strong>cMulticast</strong></span> to open its <span class="bold"><strong>Basic settings</strong></span> view in the <span class="bold"><strong>Component</strong></span> tab. </p><div class="mediaobject" align="center"><img src="../images/use_case_cmulticast_4.png" align="middle"></div></li><li class="step" title="Step 6"><p>In the <span class="bold"><strong>URIS</strong></span> table, click the plus button to add a line where you need to type in the URIs of the endpoints to receive the multicast message, for example, <span class="italic">"direct:a","direct:b"</span>.</p></li><li class="step" title="Step 7"><p>Double-click <span class="bold"><strong>direct_a</strong></span> to open its <span class="bold"><strong>Basic settings</strong></span> view in the <span class="bold"><strong>Component</strong></span> tab. </p><div class="mediaobject" align="center"><img src="../images/use_case_cmulticast_5.png" align="middle"></div></li><li class="step" title="Step 8"><p>In the <span class="bold"><strong>URI</strong></span> field, enter the endpoint URI, for example, <span class="italic">"direct:a"</span>. </p><p>Perform the same operation to <span class="bold"><strong>direct_b</strong></span> and <span class="bold"><strong>direct_c</strong></span> and type in the URIs of <span class="italic">"direct:b"</span> and <span class="italic">"direct:c"</span> respectively.</p></li></ol></div><div class="procedure" title="Procedure&nbsp;6.2.&nbsp;Configuring the content enricher and printers"><a name="d0e10898"></a><p class="title"><b>Procedure&nbsp;6.2.&nbsp;Configuring the content enricher and printers</b></p><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Double-click <span class="bold"><strong>cContentEnricher</strong></span> to open its <span class="bold"><strong>Basic settings</strong></span> view in the <span class="bold"><strong>Component</strong></span> tab. </p><div class="mediaobject" align="center"><img src="../images/use_case_cmulticast_6.png" align="middle"></div></li><li class="step" title="Step 2"><p>In the <span class="bold"><strong>Resource URI</strong></span> field, type in the URI of the endpoint whose incoming contents will be enriched with the message received by <span class="bold"><strong>cContentEnricher</strong></span>, for example, <span class="italic">"direct:c"</span>. </p><p>In the <span class="bold"><strong>Merge data</strong></span> area, select <span class="bold"><strong>using a producer</strong></span> to enable <span class="bold"><strong>cContentEnricher</strong></span> to route the received message to <span class="italic">"direct:c"</span>.</p></li><li class="step" title="Step 3"><p>Double-click <span class="bold"><strong>direct_a_print</strong></span> to open its <span class="bold"><strong>Basic settings</strong></span> view in the <span class="bold"><strong>Component</strong></span> tab. </p><div class="mediaobject" align="center"><img src="../images/use_case_cmulticast_7.png" align="middle"></div></li><li class="step" title="Step 4"><p>In the <span class="bold"><strong>Code</strong></span> box, enter the code below to print out the message received by <span class="bold"><strong>direct_a</strong></span>.</p><p>
						</p><pre class="programlisting">System.out.println("Direct a just downloaded:"+exchange.getIn().getBody(String.class));</pre><p>
					</p><p>Perform the same operation to <span class="bold"><strong>direct_b_print</strong></span> and <span class="bold"><strong>direct_c_print</strong></span> and type in the code below in their code boxes in turn: </p><p>
						</p><pre class="programlisting">System.out.println("Direct b just downloaded:"+exchange.getIn().getBody(String.class));</pre><p>
					</p><p>
						</p><pre class="programlisting">System.out.println("Direct c just downloaded:"+exchange.getIn().getBody(String.class));</pre><p>
					</p></li><li class="step" title="Step 5"><p>Press <span class="bold"><strong>Ctrl+S</strong></span> to save your Route.</p></li></ol></div></div><div class="section" title="Viewing code and executing the Route"><div class="titlepage"><div><div><h4 class="title"><a name="d0e10995"></a>Viewing code and executing the Route</h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Click the <span class="bold"><strong>Code</strong></span> tab at the bottom of the design workspace to check the generated code.</p><div class="mediaobject" align="center"><img src="../images/use_case_cmulticast_8.png" align="middle"></div><p>As shown above, the route gets the original message from <code class="code">cFile_1</code>, prints it out via <code class="code">cProcessor_1</code>, and then <code class="code">.multicast()</code> it <code class="code">to( "direct:a", "direct:b")</code>. Afterwards, the message received by <code class="code">direct_a</code> is used to <code class="code">.enrich("direct:c")</code>. </p></li><li class="step" title="Step 2"><p>Press <span class="bold"><strong>F6</strong></span> to execute the Route.</p><p>The original message is multicast to <span class="bold"><strong>direct_a</strong></span> and <span class="bold"><strong>direct_b</strong></span>. Also, it is used to enrich the contents received by <span class="bold"><strong>direct_c</strong></span>.</p><div class="mediaobject" align="center"><img src="../images/use_case_cmulticast_9.png" align="middle"></div></li></ol></div></div></div></div></body></html>