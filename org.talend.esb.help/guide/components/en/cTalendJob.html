<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>cTalendJob</title><meta name="generator" content="DocBook XSL-NS Stylesheets V1.75.2"><link rel="home" href="bk-tos-esb-mediationcomponents-rg-en..html" title="Talend Open Studio for ESB Mediation Components"><link rel="up" href="ch-processor.html" title="Chapter&nbsp;5.&nbsp;Processor components"><link rel="prev" href="cProcessor.html" title="cProcessor"><link rel="next" href="ch-routing.html" title="Chapter&nbsp;6.&nbsp;Routing components"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">cTalendJob</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="cProcessor.html">Prev</a>&nbsp;</td><th width="60%" align="center">Chapter&nbsp;5.&nbsp;Processor components</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="ch-routing.html">Next</a></td></tr></table><hr></div><div lang="EN" class="section" title="cTalendJob"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="cTalendJob"></a>cTalendJob</h2></div></div></div><div class="mediaobject"><img src="../images/cTalendJob_icon32_white.png"></div><div class="section" title="cTalendJob properties"><div class="titlepage"><div><div><h3 class="title"><a name="d0e11824"></a>cTalendJob properties</h3></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><tbody><tr><td valign="top">
							<p>
								<span class="emphasis"><strong>Component Family</strong></span>
							</p>
						</td><td colspan="2" valign="top">
							<p>Processor</p>
						</td></tr><tr><td valign="top">
							<p>
								<span class="emphasis"><strong>Function</strong></span>
							</p>
						</td><td colspan="2" valign="top">
							<p><span class="emphasis"><strong>cTalendJob</strong></span> calls a Data
								Integration Job either from the repository or exported as an OSGI
								Bundle For ESB.</p>
						</td></tr><tr><td valign="top">
							<p>
								<span class="emphasis"><strong>Purpose</strong></span>
							</p>
						</td><td colspan="2" valign="top">
							<p><span class="emphasis"><strong>cTalendJob</strong></span> allows you to call a
								Data Integration Job in a Mediation Route. For more information on
								how to build a Job and how to export a Job as an OSGI Bundle for
								ESB, see <span class="emphasis"><em>Talend Open Studio for ESB User Guide</em></span>.</p>
						</td></tr><tr><td valign="top">
							<p>
								<span class="emphasis"><strong>Basic settings</strong></span>
							</p>
						</td><td valign="top"><span class="emphasis"><em>Repository</em></span></td><td valign="top">
							<p>Select this option to call a Job from the Repository.</p>
						</td></tr><tr><td valign="top">&nbsp;</td><td valign="top"><span class="emphasis"><em>External</em></span></td><td valign="top">Select this option to call a Job that is exported as an
							OSGI Bundle For ESB.</td></tr><tr><td valign="top">&nbsp;</td><td valign="top"><span class="emphasis"><em>Job</em></span></td><td valign="top">This field appears when <span class="emphasis"><strong>Repository</strong></span> is selected. Click <span class="emphasis"><strong>[...]</strong></span> to show the <span class="emphasis"><strong>Job
								Designs</strong></span> tree view and select the Job that you want to
							call in your Route.</td></tr><tr><td valign="top">&nbsp;</td><td valign="top"><span class="emphasis"><em>Version</em></span></td><td valign="top">This field appears when <span class="emphasis"><strong>Repository</strong></span> is selected. Select the version of the Job if
							more than one verson of the Job is available.</td></tr><tr><td valign="top">&nbsp;</td><td valign="top">
							<p>
								<span class="emphasis"><em>Library</em></span>
							</p>
						</td><td valign="top">
							<p>This field appears when <span class="emphasis"><strong>External</strong></span>
								is selected. Select the library you want to import from the list, or
								click on the <span class="emphasis"><strong>[...]</strong></span> button to import
								the jar library of your Job.</p>
						</td></tr><tr><td>
							<p>&nbsp;</p>
						</td><td valign="top">
							<p>
								<span class="emphasis"><em>Job</em></span>
							</p>
						</td><td valign="top">
							<p>This field appears when <span class="emphasis"><strong>External</strong></span>
								is selected. Type in the name of the package and the name of your
								job separated by a point. For example:
									<span class="emphasis"><em>route_project.txmlmap_0_1.tXMLMap </em></span>To get
								this naming, you can open the jar library of your Job, go to
								OSGI-INF &gt; blueprint and edit the job.xml file, the naming is
								available in a bean node like <code class="code">&lt;bean id="job"
									class="route_project.txmlmap_0_1.tXMLMap"/&gt;</code></p>
						</td></tr><tr><td>
							<p>&nbsp;</p>
						</td><td valign="top">
							<p>
								<span class="emphasis"><em>Context</em></span>
							</p>
						</td><td valign="top">
							<p>Select from the list or type in the name of the context to use to
								execute your Job.</p>
						</td></tr><tr><td valign="top">
							<p>
								<span class="emphasis"><strong>Usage</strong></span>
							</p>
						</td><td colspan="2" valign="top">
							<p><span class="emphasis"><strong>cTalendJob</strong></span> can be a start, middle or end component in
								a Route. It is mandatory that a <span class="emphasis"><strong>tRouteInput</strong></span> component is used in the Data
								Integration Job. The reason for it is that this will prevent the
								referenced Job to start automatically when deployed in Talend
								Runtime. Instead it will only start when it gets called by the
								Route.</p>
						</td></tr><tr><td valign="top">
							<p>
								<span class="emphasis"><strong>Limitation</strong></span>
							</p>
						</td><td colspan="2">
							<p>&nbsp;n/a</p>
						</td></tr></tbody></table></div></div><div class="section" title="Scenario: Using camel message headers as context parameters to call a job"><div class="titlepage"><div><div><h3 class="title"><a name="andy_20120424_camel-message-header-as-context-variable-for-job-call"></a>Scenario: Using camel message headers as context parameters to call a job</h3></div></div></div><p>In this scenario, a Data Integration Job is built with a context variable defined in
			the <span class="emphasis"><strong>Integration</strong></span> perspective. Then, a Route is
			established in the <span class="emphasis"><strong>Mediation</strong></span> perspective with the
			message header defined the same as the context variable in the DI Job. Meanwhile, a
				<span class="emphasis"><strong>cTalendJob</strong></span> component is deployed to call the DI Job
			and pass the value of the Route's message header to the DI Job's context variable. </p><div class="section" title="Building a DI Job and exporting it as an OSGI Bundle for ESB"><div class="titlepage"><div><div><h4 class="title"><a name="d0e12046"></a>Building a DI Job and exporting it as an OSGI Bundle for ESB</h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>In the <span class="emphasis"><strong>Integration</strong></span> perspective, drop the
						following components from the <span class="emphasis"><strong>Palette</strong></span> onto
						the workspace: <span class="emphasis"><strong>tFixedFlowInput</strong></span> and
							<span class="emphasis"><strong>tLogRow</strong></span>.</p></li><li class="step" title="Step 2"><p>Link the components using a <span class="emphasis"><strong>Row</strong></span> &gt;
							<span class="emphasis"><strong>Main</strong></span> connection.</p><div class="mediaobject"><img src="../images/use_case_ctalendjob_1.png"></div></li><li class="step" title="Step 3"><p>Double-click <span class="emphasis"><strong>tFixedFlowInput</strong></span> to open its
							<span class="emphasis"><strong>Basic settings</strong></span> view in the <span class="emphasis"><strong>Component</strong></span> tab. </p><div class="mediaobject"><img src="../images/use_case_ctalendjob_2.png"></div></li><li class="step" title="Step 4"><p>Click the<span class="emphasis"><strong> [...]</strong></span> button next to <span class="emphasis"><strong>Edit schema</strong></span> to open the schema editor.</p><div class="mediaobject"><img src="../images/use_case_ctalendjob_3.png"></div><p>Click the <span class="emphasis"><strong>[+]</strong></span> button to add a
						line.</p><p>Enter <span class="emphasis"><em>file</em></span> as the column name and
						choose <span class="emphasis"><em>String</em></span> as the data type.</p><p>Click <span class="emphasis"><strong>OK</strong></span> to close the editor.</p></li><li class="step" title="Step 5"><p>Select the <span class="emphasis"><strong>Use Single Table</strong></span> option and
						enter <span class="emphasis"><em>context.file</em></span> as the value.</p><p>Note that the context <span class="emphasis"><em>default</em></span> with the
						variable <span class="emphasis"><em>file</em></span> has been defined.</p><p>For more information about the context setup, see <span class="emphasis"><em>Talend Open Studio for ESB User
						Guide</em></span>. </p></li><li class="step" title="Step 6"><p>Double-click <span class="emphasis"><strong>tLogRow</strong></span> to open its
							<span class="emphasis"><strong>Basic settings</strong></span> view in the <span class="emphasis"><strong>Component</strong></span> tab. </p><div class="mediaobject" align="center"><img src="../images/use_case_ctalendjob_4.png" align="middle"></div></li><li class="step" title="Step 7"><p>Select <span class="emphasis"><strong>Table (print values in cells of a table)</strong></span> for a
						better display.</p></li><li class="step" title="Step 8"><p>Press <span class="emphasis"><strong>Ctrl+S</strong></span> to save the Job.</p></li><li class="step" title="Step 9"><p>Export the Job as an <span class="emphasis"><em>OSGI Bundle for
							ESB</em></span>.</p></li><li class="step" title="Step 10"><p>Unzip the generated jar file.</p></li></ol></div></div><div class="section" title="Building a Route for exchanging messages and calling the DI Job"><div class="titlepage"><div><div><h4 class="title"><a name="d0e12180"></a>Building a Route for exchanging messages and calling the DI Job</h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>In the <span class="emphasis"><strong>Mediation</strong></span> perspective, drop the
						following components from the <span class="emphasis"><strong>Palette</strong></span> onto
						the workspace: <span class="emphasis"><strong>cFile</strong></span>, <span class="emphasis"><strong>cSetHeader</strong></span> and <span class="emphasis"><strong>cTalendJob</strong></span>,
						respectively labelled as <span class="emphasis"><strong>File_Source</strong></span>,
							<span class="emphasis"><strong>Set_Header</strong></span> and <span class="emphasis"><strong>Call_DI-Job</strong></span>.</p></li><li class="step" title="Step 2"><p>Link the components using a <span class="emphasis"><strong>Row</strong></span> &gt;
							<span class="emphasis"><strong>Route</strong></span> connection.</p><div class="mediaobject"><img src="../images/use_case_ctalendjob_5.png"></div></li><li class="step" title="Step 3"><p>Double-click <span class="emphasis"><strong>cFile</strong></span> to open its <span class="emphasis"><strong>Basic settings</strong></span> view in the <span class="emphasis"><strong>Component</strong></span> tab. </p><div class="mediaobject"><img src="../images/use_case_ctalendjob_6.png"></div></li><li class="step" title="Step 4"><p>In the <span class="emphasis"><strong>Path</strong></span> field, enter the variable
							<span class="emphasis"><em>context.root_dir</em></span> to specify the file
						path.</p><p>Keep other default settings as they are.</p><p>For more information about the context setup, see <span class="emphasis"><em>Talend Open Studio for ESB User
							Guide</em></span>. </p></li><li class="step" title="Step 5"><p>Double-click <span class="emphasis"><strong>cSetHeader</strong></span> to open its
							<span class="emphasis"><strong>Basic settings</strong></span> view in the <span class="emphasis"><strong>Component</strong></span> tab. </p><div class="mediaobject" align="center"><img src="../images/use_case_ctalendjob_7.png" align="middle"></div></li><li class="step" title="Step 6"><p>Click <span class="emphasis"><strong>[+]</strong></span> to add a row to the <span class="emphasis"><strong>Headers</strong></span> table.</p><p>In the <span class="emphasis"><strong>Name</strong></span> field, enter <span class="emphasis"><em>file</em></span>, which is the same as the context variable
						of the DI Job.</p><p>Select <span class="emphasis"><em>Simple</em></span> from the <span class="emphasis"><strong>Language</strong></span> list.</p><p>In the <span class="emphasis"><strong>Value</strong></span> field, enter <span class="emphasis"><em>${header.camelfilename}</em></span> to get the file
						name.</p></li><li class="step" title="Step 7"><p>Double-click <span class="emphasis"><strong>cTalendJob</strong></span> to open its
							<span class="emphasis"><strong>Basic settings</strong></span> view in the <span class="emphasis"><strong>Component</strong></span> tab. </p><div class="mediaobject"><img src="../images/use_case_ctalendjob_8.png"></div></li><li class="step" title="Step 8"><p>Select the <span class="emphasis"><strong>External</strong></span> option and click the
							<span class="emphasis"><strong>[...]</strong></span> button to browse the generated
						jar file for the DI Job.</p></li><li class="step" title="Step 9"><p>Go to the unzipped folder of the above JAR file and open the <span class="emphasis"><em>job.xml</em></span> in the <span class="emphasis"><em>&lt;DI_Job_JAR_Path&gt;\OSGI-INF\blueprint</em></span> folder, <span class="emphasis"><em>E:\cTalendJob_ShowContextVar-0.1\OSGI-INF\blueprint</em></span> in this
						example. </p><p>Go to the <span class="emphasis"><em>bean</em></span> tag and copy the content
						of the attribute <span class="emphasis"><em>class</em></span>, <span class="emphasis"><em>work.ctalendjob_showcontextvar_0_1.cTalendJob_ShowContextVar</em></span>
						in this example.</p><p>Paste it in the <span class="emphasis"><strong>Job</strong></span> field.</p></li><li class="step" title="Step 10"><p>Press <span class="emphasis"><strong>Ctrl+S</strong></span> to save the Route.</p></li></ol></div></div><div class="section" title="Viewing the code and executing the Route"><div class="titlepage"><div><div><h4 class="title"><a name="d0e12360"></a>Viewing the code and executing the Route</h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Click the <span class="emphasis"><strong>Code</strong></span> tab at the bottom of the
						design workspace to check the generated code.</p><div class="mediaobject"><img src="../images/use_case_ctalendjob_9.png"></div><p>As shown above, <code class="code">File_Source</code> provides a file for the message
						exchange, <code class="code">cSetHeader</code> sets a message header and uses the source
						file name as the header value, and finally that value is passed to
							<code class="code">cTalendJob_1</code> for execution of the DI Job.</p></li><li class="step" title="Step 2"><p>Press <span class="emphasis"><strong>F6</strong></span> to execute the Route.</p></li><li class="step" title="Step 3"><p>Put a file into the folder specified by <span class="emphasis"><em>context.root_dir</em></span>, <span class="emphasis"><em>test
							mail.txt</em></span> in this example.</p><p>The result below can be found.</p><div class="mediaobject"><img src="../images/use_case_ctalendjob_10.png"></div><p>As shown above, the source file name is displayed via <span class="emphasis"><strong>tLogRow</strong></span> as the Route's message header value has
						been passed to the context variable of the DI Job.</p></li></ol></div></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="cProcessor.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="ch-processor.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="ch-routing.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">cProcessor&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="bk-tos-esb-mediationcomponents-rg-en..html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;Chapter&nbsp;6.&nbsp;Routing
			components</td></tr></table></div></body></html>